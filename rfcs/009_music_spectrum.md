- 功能名称: 音乐频谱
- 开始时间: 2024-05-30

# 摘要

用Rust设计一款"音乐频谱"的功能，运行在 esp32c3 上，显示在`8*8`的 ws2812 点阵上。

# 目的

Rust、esp32c3、ws2812 的学习使用；
esp32c3通过ADC采集麦克风音频信号，再通过fft转换，显示到`8*8`的ws2812上。

# 解释

## FT

**傅里叶变换**（Fourier Transform）是一种分析信号的方法，它将一个函数从时域（或空域）转换到频域（或谱域）。这种变换通过分解信号为不同频率的正弦波和余弦波（或称为复指数波）的叠加来工作。

具体来说，傅里叶变换将一个时间或空间域内的函数f(t)（或f(x)）转换为一系列正弦和余弦波（或复指数波）的叠加，这些正弦和余弦波有不同的频率、振幅和相位。转换后的函数通常表示为F(ω)（或F(k)），其中ω是角频率，k是波数或空间频率。

傅里叶变换有两种主要形式：

- **连续傅里叶变换（Continuous Fourier Transform, CFT）**，适用于连续时间或空间信号。
- **离散傅里叶变换（Discrete Fourier Transform, DFT）**，适用于离散时间或空间信号。在数字信号处理中，我们更常用DFT，因为它可以将一个时间域的信号转换为一个复数域的频域信号。

在实际应用中，傅里叶变换被广泛应用于信号处理、图像处理、通信、控制系统、量子力学、声学等领域。例如，在信号处理中，傅里叶变换可以帮助我们分析信号的频率成分，从而提取有用的信息或进行信号滤波；在图像处理中，傅里叶变换可以用于图像增强、图像去噪、图像压缩等。

另外，由于直接计算傅里叶变换的计算量较大，快速傅里叶变换（Fast Fourier Transform, FFT）算法被开发出来以加速计算过程。FFT算法通过利用傅里叶变换的对称性和周期性等性质，将计算复杂度从O(N^2)降低到O(N log N)，大大提高了计算效率。

### DFT

**离散傅里叶变换**（Discrete Fourier Transform，DFT） 是一种数学方法，用于将时域（或空域）上定义的离散信号转换为频域上的表示。这是信号处理和分析中的一个重要工具，因为它允许我们观察和分析信号的频率内容。

具体地说，DFT 将一个长度为 `N` 的复数序列 `x[n]`（其中 n 是整数且 0≤n<N）转换为一个同样长度的复数序列 `X[k]`，这个新序列表示了原信号在频域上的特性。

与连续傅里叶变换（Fourier Transform，FT）相比，DFT 是在离散时间（或空间）上定义的，并且通常用于处理数字信号。在数字信号处理中，信号通常是作为时间序列或空间序列的样本点来获取的，这些样本点是离散的，因此需要使用 `DFT` 而不是 `FT`。

另外，值得注意的是，虽然 DFT 在理论上非常有用，但其计算复杂度为 O(N^2)，这意味着对于较大的 N，计算可能会非常耗时。为了解决这个问题，快速傅里叶变换（Fast Fourier Transform，FFT）算法被开发出来，它可以以 O(NlogN) 的复杂度计算 DFT，大大提高了计算效率。

### FFT

**FFT**（Fast Fourier Transform，快速傅里叶变换） 是一种高效计算离散傅里叶变换（DFT）及其逆变换的算法。它可以将一个信号从时域（或空域）变换到频域（或谱域）。FFT通过减少计算离散傅里叶变换（DFT）所需要的乘法次数来提高转换速度，其效率远高于直接计算DFT。

# 详细设计

## 界面设计

```Text
00100100
00000000
00100100
10100101
10100101
00100100
00000000
00100100
```

## 设计

## 映射函数

```Text
定义：
    映射函数是集合与集合之间的一种对应关系，特别地，数集到数集的映射即为函数。
    设X和Y为非空集合，若存在对应法则f，使得对每个x∈X都有唯一确定的y∈Y与之对应，则称f为从X到Y的映射。
简化步骤：
    确定输入输出范围：
        首先明确输入范围（或域），即x的取值范围（例如，0到1023）。
        接着确定输出范围（或目标域），即y的取值范围（例如，0到255）。
    计算缩放因子：
        缩放因子为输出范围的大小与输入范围的大小的比值，即 (out_max - out_min) / (in_max - in_min)。
    应用映射：
        映射的计算公式为：y = (x - in_min) * 缩放因子 + out_min。
        通过这个公式，可以将输入值x映射到输出值y，确保y在指定的输出范围内。
示例：
    假设我们有一个传感器读数x，其范围为0到1023，我们想要将其映射到0到255的范围内用于PWM控制LED。
    输入范围：in_min = 0, in_max = 1023
    输出范围：out_min = 0, out_max = 255
    缩放因子 = (255 - 0) / (1023 - 0)
    映射后的值y = (x - 0) * 缩放因子 + 0
注意：
    映射函数通常是线性的，意味着输入值的增加会导致输出值按相同比例增加。
    在实际应用中，映射函数可以根据需要进行调整，例如使用非线性映射来处理特定的数据分布。
    在编程时，映射函数通常被实现为函数或方法，以便在需要时轻松应用。
归纳：
    映射函数是数据处理中常用的工具，它可以将数据从一个范围线性地转换到另一个范围，以适应不同的应用需求。
    通过明确输入输出范围、计算缩放因子并应用映射公式，可以轻松地实现映射函数的功能。
```

# 未解决的问题

无

# 缺点

# 替代品

# 未来展望

无

# 参考链接

- https://zhuanlan.zhihu.com/p/19759362
